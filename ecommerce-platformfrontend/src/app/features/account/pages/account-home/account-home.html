<div class="account-container">
  <div class="account-header">
    <h2>Mon Compte</h2>
    <button mat-raised-button color="warn" (click)="logout()">
      <mat-icon>logout</mat-icon>
      Se d√©connecter
    </button>
  </div>

  <div class="info-box">
    <p><strong>Bienvenue dans votre espace personnel !</strong></p>
    <p>G√©rez vos commandes, votre profil et vos pr√©f√©rences.</p>
  </div>

  <!-- Espace Client -->
  <div class="client-space" *ngIf="user && !isAdmin">
    <h3>üë§ Informations personnelles</h3>
    <div class="user-info">
      <p><strong>Nom :</strong> {{ user.name }}</p>
      <p><strong>Email :</strong> {{ user.email }}</p>
      <p><strong>T√©l√©phone :</strong> {{ user.phone || 'Non renseign√©' }}</p>
    </div>

    <h3>üì¶ Mes commandes</h3>
    <div class="orders-section" *ngIf="orders.length > 0; else noOrders">
      <div class="order-card" *ngFor="let order of orders">
        <div class="order-header">
          <h4>Commande #{{ order.id }}</h4>
          <span class="order-status" [class]="'status-' + order.status">
            {{ getStatusText(order.status) }}
          </span>
        </div>
        <div class="order-details">
          <p><strong>Date :</strong> {{ order.date | date:'dd/MM/yyyy HH:mm' }}</p>
          <p><strong>Total :</strong> {{ order.total | currency:'XOF' }}</p>
          <p><strong>Adresse :</strong> {{ order.shippingAddress?.address || 'Non renseign√©e' }}</p>
        </div>
        <div class="order-actions">
          <button mat-stroked-button (click)="viewOrderDetails(order)">
            <mat-icon>visibility</mat-icon>
            Voir les d√©tails
          </button>
          <button mat-stroked-button (click)="downloadInvoice(order)">
            <mat-icon>download</mat-icon>
            T√©l√©charger la facture
          </button>
        </div>
      </div>
    </div>
    <ng-template #noOrders>
      <p>Aucune commande pour le moment.</p>
    </ng-template>

    <h3>üìç Mes adresses</h3>
    <div class="addresses-section" *ngIf="addresses.length > 0; else noAddresses">
      <div class="address-card" *ngFor="let address of addresses">
        <p><strong>{{ address.name }}</strong></p>
        <p>{{ address.address }}</p>
        <p>{{ address.city }}, {{ address.postalCode }}</p>
        <p>{{ address.country }}</p>
      </div>
    </div>
    <ng-template #noAddresses>
      <p>Aucune adresse enregistr√©e.</p>
    </ng-template>

    <h3>‚ù§Ô∏è Mes favoris</h3>
    <div class="favorites-section" *ngIf="favorites.length > 0; else noFavorites">
      <div class="favorite-item" *ngFor="let product of favorites">
        <img [src]="product.image" [alt]="product.name" class="product-image">
        <div class="product-info">
          <h4>{{ product.name }}</h4>
          <p>{{ product.price | currency:'XOF' }}</p>
          <button mat-stroked-button (click)="addToCart(product)">
            <mat-icon>add_shopping_cart</mat-icon>
            Ajouter au panier
          </button>
        </div>
      </div>
    </div>
    <ng-template #noFavorites>
      <p>Aucun produit en favoris.</p>
    </ng-template>
  </div>

  <!-- Espace Admin -->
  <div class="admin-space" *ngIf="isAdmin">
    <h3>üîß Espace Administrateur</h3>
    <div class="admin-stats">
      <div class="stat-card">
        <h4>Total Commandes</h4>
        <p>{{ allOrders.length }}</p>
      </div>
      <div class="stat-card">
        <h4>Commandes en attente</h4>
        <p>{{ getPendingOrders().length }}</p>
      </div>
      <div class="stat-card">
        <h4>Total Produits</h4>
        <p>{{ products.length }}</p>
      </div>
    </div>

    <h3>üìã Toutes les commandes</h3>
    <div class="orders-section">
      <div class="order-card" *ngFor="let order of allOrders">
        <div class="order-header">
          <h4>Commande #{{ order.id }} - {{ order.userName }}</h4>
          <span class="order-status" [class]="'status-' + order.status">
            {{ getStatusText(order.status) }}
          </span>
        </div>
        <div class="order-details">
          <p><strong>Date :</strong> {{ order.date | date:'dd/MM/yyyy HH:mm' }}</p>
          <p><strong>Total :</strong> {{ order.total | currency:'XOF' }}</p>
          <p><strong>Client :</strong> {{ order.userName }}</p>
        </div>
        <div class="order-actions">
          <button mat-stroked-button (click)="viewOrderDetails(order)">
            <mat-icon>visibility</mat-icon>
            Voir les d√©tails
          </button>
          <button mat-stroked-button (click)="updateOrderStatus(order.id, 'shipped')" 
                  *ngIf="order.status === 'pending'">
            <mat-icon>local_shipping</mat-icon>
            Marquer comme exp√©di√©e
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
